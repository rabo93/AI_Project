<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" >
<!-- <html xmlns:th="https://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"  -->
<!-- 		layout:decorate="~{layouts/layout}"> -->
<head>
	<title layout:fragment="title">ì±—ë´‡ Q&A</title>
	<link href="/css/chatbot.css" rel="stylesheet">
</head>
<body>
	<div layout:fragment="content">
		<div class="chatbot-title">ðŸ¤– ChatBORA ðŸ¤–</div>
		<div class="chat-container">
<!-- 		    <div class="messages"> -->
<!-- 		        ì‚¬ìš©ìž ì§ˆë¬¸ -->
<!-- 		        <div th:if="${param.question != null}" class="message user"> -->
<!-- 		            [[${param.question}]] -->
<!-- 		        </div> -->
		
<!-- 		        ì±—ë´‡ ë‹µë³€ -->
<!-- 		        <div th:if="${answer != null}" class="message bot"> -->
<!-- 		            [[${answer}]] -->
<!-- 		        </div> -->
<!-- 		    </div> -->

		    <!-- ëŒ€í™” ë‚´ì—­ ì¶œë ¥í•˜ê¸° -->
		    <div class="messages">
		    	<div th:each="msg : ${chatHistory}" 
				     th:class="'message ' + (${msg.role} == 'user' ? 'user' : 'bot')">
<!-- 				    <pre th:text="${msg.content}"></pre> pre íƒœê·¸ëŠ” ì¤„ë°”ê¿ˆê³¼ ê³µë°±ì„ ê·¸ëŒ€ë¡œ ì¶œë ¥ -->
					<div th:utext="${msg.content}"></div> <!-- HTML ë Œë”ë§ í—ˆìš© -->
				</div>
		    </div>
		
		    <!-- ì§ˆë¬¸ ìž…ë ¥ì°½ -->
		    <form class="chat-form" action="/chatbot/question" method="post">
		        <input type="text" name="question" placeholder="ì§ˆë¬¸ì„ ìž…ë ¥í•˜ì„¸ìš”." required>
		        <button type="submit">ì „ì†¡</button>
		    </form>
		    
		</div>
	    <form class="chat-form" action="/chatbot/reset" method="get">
		    <button type="submit">ëŒ€í™” ì´ˆê¸°í™”</button>
		</form>
	</div>
	
	
	
	<!-- JS -->
	<script src="js/jquery-3.7.1.js"></script>
	<th:block layout:fragment="script">
		<script>
			window.addEventListener("beforeunload", function() {
				navigator.sendBeacon("/chatbot/reset");
			});
		
		</script>
	</th:block>
	
	
</body>
</html>